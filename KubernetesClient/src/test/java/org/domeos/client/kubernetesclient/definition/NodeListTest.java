package org.domeos.client.kubernetesclient.definition;

import com.fasterxml.jackson.databind.ObjectMapper;
import junit.framework.TestCase;
import org.domeos.client.kubernetesclient.definitions.v1.NodeList;
import org.junit.Before;
import org.junit.Test;

import java.io.IOException;

/**
 * Created by anningluo on 15-11-26.
 */
public class NodeListTest extends TestCase {
    String nodesStr;
    ObjectMapper objectMapper;
    @Before
    public void setUp() {
        // nodesStr = "{\"kind\":\"NodeList\",\"apiVersion\":\"v1\",\"metadata\":{\"selfLink\":\"/api/v1/nodes\",\"resourceVersion\":\"251808\"},\"items\":[{\"metadata\":{\"name\":\"bx-42-198\",\"selfLink\":\"/api/v1/nodes/bx-42-198\",\"uid\":\"e0c32919-8dff-11e5-9d8e-848f69dc84eb\",\"resourceVersion\":\"251808\",\"creationTimestamp\":\"2015-11-18T14:23:03Z\",\"labels\":{\"kubernetes.io/hostname\":\"bx-42-198\"}},\"spec\":{\"externalID\":\"bx-42-198\"},\"status\":{\"capacity\":{\"cpu\":\"16\",\"memory\":\"98823140Ki\",\"pods\":\"40\"},\"conditions\":[{\"type\":\"Ready\",\"status\":\"True\",\"lastHeartbeatTime\":\"2015-11-26T10:03:42Z\",\"lastTransitionTime\":\"2015-11-18T14:59:03Z\",\"reason\":\"KubeletReady\",\"message\":\"kubelet is posting ready status\"},{\"type\":\"OutOfDisk\",\"status\":\"False\",\"lastHeartbeatTime\":\"2015-11-26T10:03:42Z\",\"lastTransitionTime\":\"2015-11-18T14:59:03Z\",\"reason\":\"KubeletHasSufficientDisk\",\"message\":\"kubelet has sufficient disk space available\"}],\"addresses\":[{\"type\":\"LegacyHostIP\",\"address\":\"10.16.42.198\"},{\"type\":\"InternalIP\",\"address\":\"10.16.42.198\"}],\"daemonEndpoints\":{\"kubeletEndpoint\":{\"Port\":10250}},\"nodeInfo\":{\"machineID\":\"30e97149af8d476f9ff5d12c8a9b7310\",\"systemUUID\":\"44454C4C-3200-1050-8043-C8C04F443358\",\"bootID\":\"a8d077ed-5d68-4993-933e-a3be35721e6b\",\"kernelVersion\":\"3.10.0-229.el7.x86_64\",\"osImage\":\"Red Hat Enterprise Linux Server 7.1 (Maipo)\",\"containerRuntimeVersion\":\"docker://1.8.2\",\"kubeletVersion\":\"v1.1.2-beta.0-dirty\",\"kubeProxyVersion\":\"v1.1.2-beta.0-dirty\"}}},{\"metadata\":{\"name\":\"bx-42-199\",\"selfLink\":\"/api/v1/nodes/bx-42-199\",\"uid\":\"a8f68df3-8e03-11e5-83dc-848f69dc84eb\",\"resourceVersion\":\"251807\",\"creationTimestamp\":\"2015-11-18T14:50:07Z\",\"labels\":{\"kubernetes.io/hostname\":\"bx-42-199\"}},\"spec\":{\"externalID\":\"bx-42-199\"},\"status\":{\"capacity\":{\"cpu\":\"16\",\"memory\":\"98823132Ki\",\"pods\":\"40\"},\"conditions\":[{\"type\":\"Ready\",\"status\":\"True\",\"lastHeartbeatTime\":\"2015-11-26T10:03:38Z\",\"lastTransitionTime\":\"2015-11-26T09:49:16Z\",\"reason\":\"KubeletReady\",\"message\":\"kubelet is posting ready status\"},{\"type\":\"OutOfDisk\",\"status\":\"False\",\"lastHeartbeatTime\":\"2015-11-26T10:03:38Z\",\"lastTransitionTime\":\"2015-11-18T14:58:15Z\",\"reason\":\"KubeletHasSufficientDisk\",\"message\":\"kubelet has sufficient disk space available\"}],\"addresses\":[{\"type\":\"LegacyHostIP\",\"address\":\"10.16.42.199\"},{\"type\":\"InternalIP\",\"address\":\"10.16.42.199\"}],\"daemonEndpoints\":{\"kubeletEndpoint\":{\"Port\":10250}},\"nodeInfo\":{\"machineID\":\"084e51d9ecb7472aa9ce33340b624ad7\",\"systemUUID\":\"44454C4C-3200-1050-8043-C6C04F443358\",\"bootID\":\"4e9d6b37-e0f5-4e4b-bbfa-536687d8c9a8\",\"kernelVersion\":\"3.10.0-229.el7.x86_64\",\"osImage\":\"Red Hat Enterprise Linux Server 7.1 (Maipo)\",\"containerRuntimeVersion\":\"docker://1.8.2\",\"kubeletVersion\":\"v1.1.2-beta.0-dirty\",\"kubeProxyVersion\":\"v1.1.2-beta.0-dirty\"}}}]}";
        nodesStr = "{\"kind\":\"NodeList\",\"apiVersion\":\"v1\",\"metadata\":{\"selfLink\":\"/api/v1/nodes\",\"resourceVersion\":\"251808\"},\"items\":[{\"metadata\":{\"name\":\"bx-42-198\",\"selfLink\":\"/api/v1/nodes/bx-42-198\",\"uid\":\"e0c32919-8dff-11e5-9d8e-848f69dc84eb\",\"resourceVersion\":\"251808\",\"creationTimestamp\":\"2015-11-18T14:23:03Z\",\"labels\":{\"kubernetes.io/hostname\":\"bx-42-198\"}},\"spec\":{\"externalID\":\"bx-42-198\"},\"status\":{\"capacity\":{\"cpu\":\"16\",\"memory\":\"98823140Ki\",\"pods\":\"40\"},\"conditions\":[{\"type\":\"Ready\",\"status\":\"True\",\"lastHeartbeatTime\":\"2015-11-26T10:03:42Z\",\"lastTransitionTime\":\"2015-11-18T14:59:03Z\",\"reason\":\"KubeletReady\",\"message\":\"kubelet is posting ready status\"},{\"type\":\"OutOfDisk\",\"status\":\"False\",\"lastHeartbeatTime\":\"2015-11-26T10:03:42Z\",\"lastTransitionTime\":\"2015-11-18T14:59:03Z\",\"reason\":\"KubeletHasSufficientDisk\",\"message\":\"kubelet has sufficient disk space available\"}],\"addresses\":[{\"type\":\"LegacyHostIP\",\"address\":\"10.16.42.198\"},{\"type\":\"InternalIP\",\"address\":\"10.16.42.198\"}],\"daemonEndpoints\":{\"kubeletEndpoint\":{\"Port\":10250}},\"nodeInfo\":{\"machineID\":\"30e97149af8d476f9ff5d12c8a9b7310\",\"systemUUID\":\"44454C4C-3200-1050-8043-C8C04F443358\",\"bootID\":\"a8d077ed-5d68-4993-933e-a3be35721e6b\",\"kernelVersion\":\"3.10.0-229.el7.x86_64\",\"osImage\":\"Red Hat Enterprise Linux Server 7.1 (Maipo)\",\"containerRuntimeVersion\":\"docker://1.8.2\",\"kubeletVersion\":\"v1.1.2-beta.0-dirty\",\"kubeProxyVersion\":\"v1.1.2-beta.0-dirty\"}}},{\"metadata\":{\"name\":\"bx-42-199\",\"selfLink\":\"/api/v1/nodes/bx-42-199\",\"uid\":\"a8f68df3-8e03-11e5-83dc-848f69dc84eb\",\"resourceVersion\":\"251807\",\"creationTimestamp\":\"2015-11-18T14:50:07Z\",\"labels\":{\"kubernetes.io/hostname\":\"bx-42-199\"}},\"spec\":{\"externalID\":\"bx-42-199\"},\"status\":{\"capacity\":{\"cpu\":\"16\",\"memory\":\"98823132Ki\",\"pods\":\"40\"},\"conditions\":[{\"type\":\"Ready\",\"status\":\"True\",\"lastHeartbeatTime\":\"2015-11-26T10:03:38Z\",\"lastTransitionTime\":\"2015-11-26T09:49:16Z\",\"reason\":\"KubeletReady\",\"message\":\"kubelet is posting ready status\"},{\"type\":\"OutOfDisk\",\"status\":\"False\",\"lastHeartbeatTime\":\"2015-11-26T10:03:38Z\",\"lastTransitionTime\":\"2015-11-18T14:58:15Z\",\"reason\":\"KubeletHasSufficientDisk\",\"message\":\"kubelet has sufficient disk space available\"}],\"addresses\":[{\"type\":\"LegacyHostIP\",\"address\":\"10.16.42.199\"},{\"type\":\"InternalIP\",\"address\":\"10.16.42.199\"}],\"daemonEndpoints\":{\"kubeletEndpoint\":{\"Port\":10250}},\"nodeInfo\":{\"machineID\":\"084e51d9ecb7472aa9ce33340b624ad7\",\"systemUUID\":\"44454C4C-3200-1050-8043-C6C04F443358\",\"bootID\":\"4e9d6b37-e0f5-4e4b-bbfa-536687d8c9a8\",\"kernelVersion\":\"3.10.0-229.el7.x86_64\",\"osImage\":\"Red Hat Enterprise Linux Server 7.1 (Maipo)\",\"containerRuntimeVersion\":\"docker://1.8.2\",\"kubeletVersion\":\"v1.1.2-beta.0-dirty\",\"kubeProxyVersion\":\"v1.1.2-beta.0-dirty\"}}}]}";
        objectMapper = new ObjectMapper();
    }

    @Test
    public void testNodeList() throws IOException {
        NodeList nodes = objectMapper.readValue(nodesStr, NodeList.class);
        System.out.println(objectMapper.writeValueAsString(nodes));
    }
}
