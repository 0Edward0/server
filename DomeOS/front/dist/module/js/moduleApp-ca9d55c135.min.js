var moduleApp=angular.module("moduleApp",["ngAnimate","ui.bootstrap","publicModule","domeModule","userModule"]);moduleApp.controller("appCtr",["$scope","$modal","$publicApi",function(o,n,e){"use strict";o.domeVersion="",e.getDomeVersion().then(function(n){n.data.result&&(o.domeVersion="v"+n.data.result)}),e.getCurrentUser().then(function(n){o.loginUser=n.data.result}),o.modifyPw=function(){n.open({animation:!0,templateUrl:"modifyPwModal.html",controller:"ModifyPwModalCtr",size:"md",resolve:{loginUser:function(){return o.loginUser}}})},o.modifySelfInfo=function(){var e=n.open({templateUrl:"modifyUserInfoModal.html",controller:"ModifyUserInfoCtr",size:"md",resolve:{user:function(){return angular.copy(o.loginUser)}}});e.result.then(function(n){angular.extend(o.loginUser,n)})},o.logout=function(){e.logout()}}]).controller("ModifyPwModalCtr",["$scope","loginUser","$modalInstance","$http","$modal","$domePublic",function(o,n,e,t,r,l){"use strict";o.pwObj={username:n.username,oldpassword:"",newpassword:""},o.newPwAgain="",o.modiftPw=function(){t.post("/api/user/changePassword",angular.toJson(o.pwObj)).then(function(){l.openPrompt("修改成功，请重新登录！")["finally"](function(){location.href="/login/login.html?redirect="+encodeURIComponent(location.href)})},function(){l.openWarning("修改失败！")})},o.cancel=function(){e.dismiss("cancel")}}]);